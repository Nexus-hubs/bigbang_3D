<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Solar System - Interactive Cosmic Journey</title>
    <style>
        /* Combined CSS from both files */

        /* Root variables for consistent theming */
        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #1a1f2e;
            --bg-tertiary: #252b3d;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-glow: #a78bfa;
            --accent-timeline: #00B5C9;
            --accent-timeline-glow: #00D9F5;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border-color: rgba(148, 163, 184, 0.2);
            --shadow-dark: rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #000000 100%);
            overflow: hidden;
            color: #FFFFFF;
            touch-action: none;
            position: relative;
            height: 100vh;
            height: -webkit-fill-available;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 20%, rgba(0, 181, 201, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(155, 89, 182, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* View container */
        .view-container {
            position: relative;
            width: 100%;
            height: 100vh;
            height: -webkit-fill-available;
        }

        .view-solar-system {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0e1a 0%, #1a0f2e 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s, visibility 0.5s;
        }

        #loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-content {
            text-align: center;
            padding: 20px;
        }

        .loading-content h2 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .solar-system-loader {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
        }

        .solar-system-loader .sun {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 25px;
            height: 25px;
            margin: -12.5px 0 0 -12.5px;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700, #ff8c00);
            box-shadow: 0 0 20px #ffd700, 0 0 40px #ff8c00;
            animation: pulse 2s ease-in-out infinite;
        }

        .solar-system-loader .planet {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            margin: -4px 0 0 -4px;
            border-radius: 50%;
            background: #4a9eff;
            box-shadow: 0 0 8px #4a9eff;
            animation: orbit 2s linear infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        @keyframes orbit {
            from { transform: rotate(0deg) translateX(40px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(40px) rotate(-360deg); }
        }

        .loading-bar {
            width: 180px;
            height: 3px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 15px;
        }

        .loading-progress {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        /* Canvas Containers */
        #canvas-container-timeline, #canvas-container-solar {
            width: 100vw;
            height: 100vh;
            position: relative;
            z-index: 1;
        }

        /* Enhanced Controls - Timeline */
        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 10, 15, 0.95);
            padding: 18px 24px;
            border-radius: 24px;
            border: 1px solid rgba(0, 181, 201, 0.3);
            backdrop-filter: blur(20px);
            z-index: 100;
            width: calc(100% - 40px);
            max-width: 750px;
            box-shadow: 0 12px 40px rgba(0, 181, 201, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        #timeline-slider {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #1a1a2e 0%, #00B5C9 var(--slider-value, 0%), #1a1a2e var(--slider-value, 0%));
            outline: none;
            border-radius: 5px;
            margin: 0;
            cursor: pointer;
            position: relative;
        }

        #timeline-slider::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 0;
            right: 0;
            height: 18px;
            background: transparent;
            pointer-events: none;
        }

        #timeline-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #00B5C9, #00D9F5);
            cursor: grab;
            border-radius: 50%;
            box-shadow: 0 0 24px rgba(0, 181, 201, 0.8), 0 0 48px rgba(0, 181, 201, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        #timeline-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 32px rgba(0, 181, 201, 1), 0 0 64px rgba(0, 181, 201, 0.6);
        }

        #timeline-slider::-webkit-slider-thumb:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        #timeline-slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #00B5C9, #00D9F5);
            cursor: grab;
            border-radius: 50%;
            border: none;
            box-shadow: 0 0 24px rgba(0, 181, 201, 0.8);
        }

        .control-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .control-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #00B5C9, #0095A8);
            color: #FFFFFF;
            border: none;
            padding: 12px 20px;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0, 181, 201, 0.3);
            white-space: nowrap;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            background: linear-gradient(135deg, #00D9F5, #00B5C9);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 181, 201, 0.5);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 181, 201, 0.3);
        }

        .time-display {
            text-align: center;
            color: #00D9F5;
            font-size: 16px;
            font-weight: 600;
            text-shadow: 0 0 12px rgba(0, 217, 245, 0.6);
            background: rgba(0, 217, 245, 0.05);
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(0, 217, 245, 0.2);
            min-width: 200px;
        }

        /* Header - Solar System */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(10, 14, 26, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow-dark);
        }

        .header h1 {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-right {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }

        .btn-icon:active {
            transform: scale(0.95);
            background: var(--accent-primary);
        }

        .btn-icon.active {
            background: var(--accent-primary);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.5);
        }

        /* Bottom Control Bar - Solar System */
        .bottom-control-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 31, 46, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
            padding: 15px;
            z-index: 90;
            max-height: 25vh;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .bottom-control-bar.hidden {
            transform: translateY(100%);
        }

        .control-toggle {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 30px;
            background: rgba(26, 31, 46, 0.95);
            border-radius: 15px 15px 0 0;
            border: 1px solid var(--border-color);
            border-bottom: none;
            z-index: 91;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        .control-toggle:active {
            transform: translateX(-50%) scale(0.95);
        }

        .planet-buttons-mobile {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .planet-btn-mobile {
            padding: 12px 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 10px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            text-align: center;
            font-weight: 500;
            touch-action: manipulation;
        }

        .planet-btn-mobile:active {
            transform: scale(0.95);
            background: var(--accent-primary);
        }

        .speed-control-mobile {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .speed-control-mobile label {
            font-size: 12px;
            color: var(--text-secondary);
            min-width: 70px;
        }

        .speed-control-mobile input[type="range"] {
            flex: 1;
            height: 4px;
            border-radius: 2px;
            background: var(--bg-tertiary);
            outline: none;
            -webkit-appearance: none;
        }

        .speed-control-mobile input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-primary);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(99, 102, 241, 0.5);
        }

        .speed-value-mobile {
            color: var(--accent-glow);
            font-weight: 600;
            font-size: 12px;
            min-width: 35px;
        }

        /* Enhanced Info Panel - Timeline */
        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(10, 10, 15, 0.95);
            padding: 24px;
            border-radius: 20px;
            border: 1px solid rgba(0, 181, 201, 0.3);
            backdrop-filter: blur(20px);
            max-width: 340px;
            z-index: 100;
            box-shadow: 0 12px 40px rgba(0, 181, 201, 0.15);
        }

        #info-panel h2 {
            color: #00D9F5;
            margin-bottom: 16px;
            font-size: 24px;
            text-shadow: 0 0 12px rgba(0, 217, 245, 0.6);
            font-weight: 700;
        }

        #info-panel p {
            color: #E8E8E8;
            line-height: 1.8;
            font-size: 15px;
            text-shadow: 0 0 4px rgba(255, 255, 255, 0.1);
        }

        /* Enhanced Detailed Info Panel */
        #detailed-info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(10, 10, 15, 0.95);
            padding: 24px;
            border-radius: 20px;
            border: 1px solid rgba(0, 181, 201, 0.3);
            backdrop-filter: blur(20px);
            max-width: 380px;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 12px 40px rgba(0, 181, 201, 0.15);
        }

        #detailed-info-panel h3 {
            color: #00D9F5;
            margin-bottom: 16px;
            font-size: 20px;
            text-shadow: 0 0 12px rgba(0, 217, 245, 0.6);
            font-weight: 700;
        }

        .info-section {
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0, 181, 201, 0.2);
        }

        .info-section:last-child {
            border-bottom: none;
        }

        .info-section h4 {
            color: #00B5C9;
            font-size: 16px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .info-section p {
            color: #C0C0C0;
            font-size: 14px;
            line-height: 1.7;
        }

        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .info-list li {
            color: #B0B0B0;
            font-size: 13px;
            line-height: 1.8;
            padding-left: 20px;
            position: relative;
            margin-bottom: 4px;
        }

        .info-list li:before {
            content: "‚ú¶";
            position: absolute;
            left: 0;
            color: #00B5C9;
            font-size: 10px;
        }

        /* Enhanced Instructions - Timeline */
        #instructions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(10, 10, 15, 0.95);
            padding: 16px 20px;
            border-radius: 20px;
            border: 1px solid rgba(0, 181, 201, 0.3);
            backdrop-filter: blur(20px);
            font-size: 13px;
            color: #E8E8E8;
            z-index: 100;
            box-shadow: 0 12px 40px rgba(0, 181, 201, 0.15);
            max-width: 180px;
        }

        #instructions div {
            margin: 6px 0;
            line-height: 1.5;
        }

        .instructions-title {
            color: #00D9F5;
            font-weight: 600;
            margin-bottom: 8px;
            text-shadow: 0 0 8px rgba(0, 217, 245, 0.5);
        }

        /* Info Panel - Solar System */
        .info-panel-mobile {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 31, 46, 0.98);
            backdrop-filter: blur(10px);
            z-index: 200;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .info-panel-mobile.active {
            transform: translateY(0);
        }

        .panel-header-mobile {
            position: sticky;
            top: 0;
            padding: 20px 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(26, 31, 46, 0.98);
            backdrop-filter: blur(10px);
            z-index: 10;
        }

        .panel-header-mobile h2 {
            font-size: 22px;
            color: var(--text-primary);
        }

        .close-btn-mobile {
            width: 35px;
            height: 35px;
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 24px;
            line-height: 1;
            transition: all 0.2s ease;
            touch-action: manipulation;
        }

        .close-btn-mobile:active {
            transform: scale(0.95) rotate(90deg);
            background: #ef4444;
        }

        .panel-content-mobile {
            padding: 20px 15px 40px 15px;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .panel-content-mobile p {
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 14px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .panel-content-mobile ul {
            margin: 10px 0 20px 20px;
            padding-left: 0;
        }

        .panel-content-mobile li {
            margin: 8px 0;
            line-height: 1.5;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .info-grid-mobile {
            display: grid;
            gap: 12px;
            margin: 15px 0;
        }

        .info-item-mobile {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border-left: 3px solid var(--accent-primary);
            gap: 10px;
            flex-wrap: wrap;
        }

        .info-label-mobile {
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            flex-shrink: 0;
        }

        .info-value-mobile {
            color: var(--text-primary);
            font-size: 13px;
            font-weight: 600;
            text-align: right;
            word-wrap: break-word;
            overflow-wrap: break-word;
            flex: 1;
            min-width: 0;
        }

        /* Chat Interface - Solar System */
        .chat-interface-mobile {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 31, 46, 0.98);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            z-index: 200;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .chat-interface-mobile.active {
            transform: translateY(0);
        }

        .chat-header-mobile {
            padding: 20px 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(26, 31, 46, 0.98);
        }

        .chat-header-mobile h3 {
            font-size: 18px;
            color: var(--text-primary);
        }

        .chat-messages-mobile {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .message-mobile {
            display: flex;
            flex-direction: column;
            gap: 6px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-content-mobile {
            padding: 12px 14px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
        }

        .message-mobile.user .message-content-mobile {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            align-self: flex-end;
            max-width: 85%;
        }

        .message-mobile.assistant .message-content-mobile {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            align-self: flex-start;
            max-width: 90%;
            border: 1px solid var(--border-color);
        }

        .message-mobile.assistant .message-content-mobile ul {
            margin: 8px 0 0 18px;
        }

        .message-mobile.assistant .message-content-mobile li {
            margin: 4px 0;
            color: var(--text-secondary);
            font-size: 13px;
        }

        .chat-input-container-mobile {
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 8px;
            background: rgba(26, 31, 46, 0.98);
        }

        #chatInputMobile {
            flex: 1;
            padding: 12px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
        }

        #chatInputMobile:focus {
            border-color: var(--accent-primary);
        }

        .btn-send-mobile {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            touch-action: manipulation;
        }

        .btn-send-mobile:active {
            transform: scale(0.95);
        }

        /* Toast Notifications */
        .toast-mobile {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(26, 31, 46, 0.98);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            padding: 12px 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px var(--shadow-dark);
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 80%;
            text-align: center;
            font-size: 14px;
        }

        .toast-mobile.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Quick Action Button */
        .quick-action-btn {
            position: fixed;
            bottom: 80px;
            right: 15px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 24px;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
            z-index: 89;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }

        .quick-action-btn:active {
            transform: scale(0.95);
        }


        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #00D9F5;
            font-size: 28px;
            font-weight: 600;
            text-shadow: 0 0 24px rgba(0, 217, 245, 0.8);
            text-align: center;
            z-index: 1000;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 4px;
            height: 4px;
            background: #00D9F5;
            border-radius: 50%;
            margin-left: 8px;
            animation: loading-dots 1.5s infinite;
        }

        @keyframes loading-dots {
            0%, 20% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Scrollbar Styling */
        #detailed-info-panel::-webkit-scrollbar,
        .info-panel-mobile::-webkit-scrollbar,
        .chat-messages-mobile::-webkit-scrollbar {
            width: 6px;
        }

        #detailed-info-panel::-webkit-scrollbar-track,
        .info-panel-mobile::-webkit-scrollbar-track,
        .chat-messages-mobile::-webkit-scrollbar-track {
            background: rgba(26, 26, 46, 0.3);
            border-radius: 3px;
        }

        #detailed-info-panel::-webkit-scrollbar-thumb,
        .info-panel-mobile::-webkit-scrollbar-thumb,
        .chat-messages-mobile::-webkit-scrollbar-thumb {
            background: rgba(0, 181, 201, 0.4);
            border-radius: 3px;
        }

        #detailed-info-panel::-webkit-scrollbar-thumb:hover,
        .info-panel-mobile::-webkit-scrollbar-thumb:hover,
        .chat-messages-mobile::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 181, 201, 0.6);
        }

        /* Enhanced Mobile Responsive Design */
        @media (max-width: 768px) {
            #info-panel {
                max-width: calc(100vw - 40px);
                padding: 20px;
                top: 15px;
                left: 15px;
                right: 15px;
                position: static;
                margin: 0 15px;
                order: -1;
            }

            #info-panel h2 {
                font-size: 20px;
            }

            #info-panel p {
                font-size: 14px;
            }

            #detailed-info-panel {
                max-width: calc(100vw - 40px);
                padding: 20px;
                top: auto;
                bottom: 180px;
                right: 15px;
                left: 15px;
                max-height: 250px;
                position: static;
                margin: 15px;
            }

            #controls {
                bottom: 15px;
                width: calc(100% - 30px);
                padding: 16px 20px;
                gap: 14px;
            }

            .control-buttons {
                gap: 6px;
            }

            button {
                padding: 10px 16px;
                font-size: 13px;
                min-width: 80px;
            }

            #instructions {
                display: none; /* Hide on mobile to reduce clutter */
            }

            .time-display {
                font-size: 14px;
                min-width: 180px;
            }

            .view-switcher {
                top: 15px;
                right: 15px;
                padding: 10px 16px;
            }

            .view-switcher button {
                padding: 6px 12px;
                font-size: 12px;
                min-height: 32px;
            }

            .audio-modal-content {
                margin: 20px;
                padding: 30px 20px;
            }
        }

        @media (max-width: 480px) {
            #controls {
                padding: 14px 16px;
            }

            .control-buttons {
                justify-content: center;
            }

            button {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 70px;
            }

            .time-display {
                font-size: 13px;
                min-width: 160px;
            }

            .panel-header-mobile h2 {
                font-size: 18px;
            }

            .panel-content-mobile {
                padding: 15px 12px 50px 12px;
                font-size: 13px;
            }

            .panel-content-mobile p {
                font-size: 13px;
                line-height: 1.5;
            }

            .info-label-mobile,
            .info-value-mobile {
                font-size: 12px;
            }

            .panel-content-mobile h4 {
                font-size: 14px;
            }

            .panel-content-mobile li {
                font-size: 12px;
                line-height: 1.4;
            }
        }

        /* Touch device optimization */
        @media (hover: none) and (pointer: coarse) {
            button {
                min-height: 48px;
                padding: 14px 20px;
            }

            #timeline-slider {
                height: 12px;
            }

            #timeline-slider::-webkit-slider-thumb {
                width: 32px;
                height: 32px;
            }

            .btn-icon, .planet-btn-mobile, .btn-send-mobile, .quick-action-btn {
                min-height: 44px;
            }
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            #controls, #info-panel, #detailed-info-panel, #instructions, .view-switcher {
                border: 2px solid #00D9F5;
                background: rgba(0, 0, 0, 0.95);
            }
        }

        /* Focus styles for accessibility */
        button:focus, input:focus, .btn-icon:focus, .planet-btn-mobile:focus {
            outline: 2px solid #00D9F5;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="solar-system-loader">
                <div class="sun"></div>
                <div class="planet"></div>
            </div>
            <h2>Initializing Universe...</h2>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="view-container">
        <!-- Solar System View -->
        <div class="view-solar-system" id="solar-system-view">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1>üåå Solar System</h1>
                </div>
                <div class="header-right">
                    <button id="toggleAudioMobile" class="btn-icon" title="Toggle Audio">
                        <span class="audio-icon">üîä</span>
                    </button>
                    <button id="toggleChatMobile" class="btn-icon" title="Chat">
                        <span>üí¨</span>
                    </button>
                    <button id="toggleInfoMobile" class="btn-icon" title="Info">
                        <span>‚ÑπÔ∏è</span>
                    </button>
                </div>
            </header>

            <!-- 3D Canvas Container -->
            <div id="canvas-container-solar">
                <div class="loading">Initializing Solar System...</div>
            </div>

            <!-- Control Toggle Button -->
            <div class="control-toggle" id="controlToggle">‚ò∞</div>

            <!-- Bottom Control Bar -->
            <div class="bottom-control-bar" id="bottomControlBar">
                <div class="planet-buttons-mobile" id="planetButtonsMobile"></div>

                <div class="speed-control-mobile">
                    <label>Speed:</label>
                    <input type="range" id="speedControlMobile" min="0" max="5" step="0.1" value="1">
                    <span class="speed-value-mobile" id="speedValueMobile">1.0x</span>
                </div>
            </div>

            <!-- Quick Action Button -->
            <button class="quick-action-btn" id="resetCameraMobile">üéØ</button>

            <!-- Info Panel -->
            <div id="infoPanelMobile" class="info-panel-mobile">
                <div class="panel-header-mobile">
                    <h2 id="infoPanelTitleMobile">Welcome</h2>
                    <button class="close-btn-mobile" id="closeInfoMobile">√ó</button>
                </div>
                <div class="panel-content-mobile" id="infoPanelContentMobile">
                    <p>Tap on any planet or moon to learn more! Use the chat assistant for questions.</p>
                    <div class="info-grid-mobile">
                        <div class="info-item-mobile">
                            <span class="info-label-mobile">Type:</span>
                            <span class="info-value-mobile">Solar System</span>
                        </div>
                        <div class="info-item-mobile">
                            <span class="info-label-mobile">Star:</span>
                            <span class="info-value-mobile">Sun</span>
                        </div>
                        <div class="info-item-mobile">
                            <span class="info-label-mobile">Planets:</span>
                            <span class="info-value-mobile">8</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Interface -->
            <div id="chatInterfaceMobile" class="chat-interface-mobile">
                <div class="chat-header-mobile">
                    <h3>ü§ñ Solar Assistant</h3>
                    <button class="close-btn-mobile" id="closeChatMobile">√ó</button>
                </div>
                <div class="chat-messages-mobile" id="chatMessagesMobile">
                    <div class="message-mobile assistant">
                        <div class="message-content-mobile">
                            <p>Hello! Ask me anything about space! Try:</p>
                            <ul>
                                <li>"Tell me about Mars"</li>
                                <li>"How many moons does Jupiter have?"</li>
                                <li>"What makes Saturn special?"</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="chat-input-container-mobile">
                    <input type="text" id="chatInputMobile" placeholder="Ask about planets..." />
                    <button id="sendMessageMobile" class="btn-send-mobile">Send</button>
                </div>
            </div>

            <!-- Toast Notifications -->
            <div id="toastMobile" class="toast-mobile"></div>
        </div>
    </div>

    <!-- Three.js and dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        // ==================== Combined Application ====================

        // Global variables for both views
        // Global variables
        let solarScene, solarCamera, solarRenderer, solarControls;
        let celestialBodies = {};
        let animationId;

        // ==================== Solar System Initialization ====================
        const celestialData = {
            sun: {
                name: "Sun", type: "Star", radius: 15, color: 0xFDB813,
                mass: "1.989 √ó 10¬≥‚Å∞ kg", diameter: "1,392,700 km", temperature: "5,778 K",
                info: "The Sun is the star at the center of the Solar System.",
                funFacts: ["Contains 99.86% of solar system mass", "Light takes 8 minutes to reach Earth", "About 4.6 billion years old"]
            },
            mercury: { name: "Mercury", type: "Terrestrial Planet", radius: 1.8, color: 0x8C7853, distance: 30, orbitSpeed: 0.04, rotationSpeed: 0.001, mass: "3.285 √ó 10¬≤¬≥ kg", diameter: "4,879 km", dayLength: "58.6 Earth days", yearLength: "88 Earth days", moons: 0, info: "Mercury is the smallest and innermost planet.", funFacts: ["No atmosphere to retain heat", "Fastest orbiting planet", "Named after Roman messenger god"] },
            venus: { name: "Venus", type: "Terrestrial Planet", radius: 3, color: 0xFFC649, distance: 45, orbitSpeed: 0.015, rotationSpeed: -0.0005, mass: "4.867 √ó 10¬≤‚Å¥ kg", diameter: "12,104 km", dayLength: "243 Earth days", yearLength: "225 Earth days", moons: 0, info: "Venus is Earth's closest neighbor.", funFacts: ["Hottest planet at 465¬∞C", "Rotates backwards", "Day longer than its year"] },
            earth: {
                name: "Earth", type: "Terrestrial Planet", radius: 3.5, color: 0x2233FF, distance: 65, orbitSpeed: 0.01, rotationSpeed: 0.02,
                mass: "5.972 √ó 10¬≤‚Å¥ kg", diameter: "12,742 km", dayLength: "24 hours", yearLength: "365.25 days", moons: 1,
                info: "Earth is the only known planet with life.",
                funFacts: ["Only known planet with life", "70% covered by water", "Has one natural satellite - Moon"],
                moonData: [{ name: "Moon", radius: 0.9, distance: 7, orbitSpeed: 0.03, color: 0xAAAAA, mass: "7.342 √ó 10¬≤¬≤ kg", diameter: "3,474 km", info: "Earth's only natural satellite." }]
            },
            mars: {
                name: "Mars", type: "Terrestrial Planet", radius: 2.5, color: 0xCD5C5C, distance: 85, orbitSpeed: 0.008, rotationSpeed: 0.018,
                mass: "6.39 √ó 10¬≤¬≥ kg", diameter: "6,779 km", dayLength: "24.6 hours", yearLength: "687 Earth days", moons: 2,
                info: "Mars is often called the 'Red Planet'.",
                funFacts: ["Home to Olympus Mons", "Has polar ice caps", "Day is 24.6 hours"],
                moonData: [
                    { name: "Phobos", radius: 0.4, distance: 4.5, orbitSpeed: 0.05, color: 0x998877, diameter: "22.4 km", info: "Phobos orbits closer than any other moon." },
                    { name: "Deimos", radius: 0.3, distance: 6, orbitSpeed: 0.03, color: 0xAA9988, diameter: "12.4 km", info: "Deimos takes 30 hours to orbit Mars." }
                ]
            },
            jupiter: {
                name: "Jupiter", type: "Gas Giant", radius: 9, color: 0xDAA520, distance: 120, orbitSpeed: 0.002, rotationSpeed: 0.04,
                mass: "1.898 √ó 10¬≤‚Å∑ kg", diameter: "139,820 km", dayLength: "9.9 hours", yearLength: "11.9 Earth years", moons: 79,
                info: "Jupiter is the largest planet.",
                funFacts: ["Largest planet", "Has 79 known moons", "Great Red Spot is 300 years old"],
                moonData: [
                    { name: "Io", radius: 0.7, distance: 13, orbitSpeed: 0.06, color: 0xFFFF00, diameter: "3,643 km", info: "Most volcanically active." },
                    { name: "Europa", radius: 0.6, distance: 16, orbitSpeed: 0.045, color: 0xBBCCDD, diameter: "3,122 km", info: "Has subsurface ocean." },
                    { name: "Ganymede", radius: 0.8, distance: 19, orbitSpeed: 0.035, color: 0x998866, diameter: "5,268 km", info: "Largest moon in solar system." }
                ]
            },
            saturn: {
                name: "Saturn", type: "Gas Giant", radius: 7.5, color: 0xFAD5A5, distance: 160, orbitSpeed: 0.0009, rotationSpeed: 0.038,
                mass: "5.683 √ó 10¬≤‚Å∂ kg", diameter: "116,460 km", dayLength: "10.7 hours", yearLength: "29.4 Earth years", moons: 82, rings: true,
                info: "Saturn is best known for its ring system.",
                funFacts: ["Famous for rings", "Has 82 moons", "Least dense - floats in water"]
            },
            uranus: { name: "Uranus", type: "Ice Giant", radius: 5, color: 0x4FD0E7, distance: 195, orbitSpeed: 0.0004, rotationSpeed: 0.03, mass: "8.681 √ó 10¬≤‚Åµ kg", diameter: "50,724 km", dayLength: "17.2 hours", yearLength: "84 Earth years", moons: 27, info: "Uranus rotates on its side.", funFacts: ["Rotates on its side", "Coldest atmosphere", "Has 13 rings"] },
            neptune: {
                name: "Neptune", type: "Ice Giant", radius: 4.8, color: 0x4169E1, distance: 230, orbitSpeed: 0.0001, rotationSpeed: 0.032,
                mass: "1.024 √ó 10¬≤‚Å∂ kg", diameter: "49,244 km", dayLength: "16.1 hours", yearLength: "164.8 Earth years", moons: 14,
                info: "Neptune has the strongest winds.",
                funFacts: ["Farthest from Sun", "Strongest winds", "Discovered by math"],
                moonData: [{ name: "Triton", radius: 0.6, distance: 10, orbitSpeed: 0.045, color: 0xEEDDCC, diameter: "2,707 km", info: "Only large moon with retrograde orbit." }]
            }
        };

        function initSolarSystem() {
            // Scene setup
            solarScene = new THREE.Scene();
            solarScene.background = new THREE.Color(0x000000);

            // Camera setup
            solarCamera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000);
            solarCamera.position.set(0, 80, 150);

            // Renderer setup
            solarRenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            solarRenderer.setSize(window.innerWidth, window.innerHeight);
            solarRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.getElementById('canvas-container-solar').appendChild(solarRenderer.domElement);

            // Remove loading screen
            document.querySelector('#solar-system-view .loading').remove();

            // Controls
            solarControls = new THREE.OrbitControls(solarCamera, solarRenderer.domElement);
            solarControls.enableDamping = true;
            solarControls.dampingFactor = 0.05;
            solarControls.minDistance = 25;
            solarControls.maxDistance = 400;
            solarControls.touches = { ONE: THREE.TOUCH.ROTATE, TWO: THREE.TOUCH.DOLLY_PAN };

            // Raycaster
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            // Create starfield
            createStarfield();

            // Create solar system
            createSolarSystem();

            // Setup UI
            setupSolarSystemUI();
        }

        function createStarfield() {
            const starGeometry = new THREE.BufferGeometry();
            const starMaterial = new THREE.PointsMaterial({ color: 0xFFFFFF, size: 0.6, transparent: true, opacity: 0.8 });
            const starVertices = [];
            for (let i = 0; i < 5000; i++) {
                starVertices.push(
                    (Math.random() - 0.5) * 2000,
                    (Math.random() - 0.5) * 2000,
                    (Math.random() - 0.5) * 2000
                );
            }
            starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            const stars = new THREE.Points(starGeometry, starMaterial);
            solarScene.add(stars);
        }

        function createSolarSystem() {
            // Create Sun
            const sunGeometry = new THREE.SphereGeometry(celestialData.sun.radius, 32, 32);
            const sunMaterial = new THREE.MeshBasicMaterial({ color: celestialData.sun.color, emissive: celestialData.sun.color, emissiveIntensity: 1 });
            const sun = new THREE.Mesh(sunGeometry, sunMaterial);
            sun.userData = celestialData.sun;
            solarScene.add(sun);
            celestialBodies.sun = sun;

            // Add sun glow
            const glowGeometry = new THREE.SphereGeometry(celestialData.sun.radius * 1.2, 32, 32);
            const glowMaterial = new THREE.MeshBasicMaterial({ color: 0xFFA500, transparent: true, opacity: 0.3 });
            const glow = new THREE.Mesh(glowGeometry, glowMaterial);
            sun.add(glow);

            // Add lighting
            const sunLight = new THREE.PointLight(0xFFFFFF, 2, 1000);
            sunLight.position.set(0, 0, 0);
            solarScene.add(sunLight);

            const ambientLight = new THREE.AmbientLight(0x333333);
            solarScene.add(ambientLight);

            // Create planets
            Object.keys(celestialData).forEach(key => {
                if (key !== 'sun') createPlanet(key, celestialData[key]);
            });
        }

        function createPlanet(key, data) {
            const orbitGeometry = new THREE.RingGeometry(data.distance - 0.2, data.distance + 0.2, 64);
            const orbitMaterial = new THREE.MeshBasicMaterial({ color: 0x444444, side: THREE.DoubleSide, transparent: true, opacity: 0.3 });
            const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
            orbit.rotation.x = Math.PI / 2;
            solarScene.add(orbit);

            const planetGeometry = new THREE.SphereGeometry(data.radius, 24, 24);
            const planetMaterial = new THREE.MeshStandardMaterial({ color: data.color, metalness: 0.4, roughness: 0.7 });
            const planet = new THREE.Mesh(planetGeometry, planetMaterial);
            planet.userData = data;
            planet.userData.key = key;

            const planetGroup = new THREE.Group();
            planetGroup.add(planet);
            planet.position.x = data.distance;
            solarScene.add(planetGroup);

            celestialBodies[key] = { planet: planet, group: planetGroup, angle: Math.random() * Math.PI * 2, moons: [] };

            if (data.rings) {
                const ringGeometry = new THREE.RingGeometry(data.radius * 1.2, data.radius * 2, 32);
                const ringMaterial = new THREE.MeshBasicMaterial({ color: 0xCCAAAA, side: THREE.DoubleSide, transparent: true, opacity: 0.6 });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.rotation.x = Math.PI / 2;
                planet.add(ring);
            }

            if (data.moonData) {
                data.moonData.forEach((moonData, index) => createMoon(planet, moonData, key, index));
            }
        }

        function createMoon(planet, moonData, planetKey, moonIndex) {
            const moonGeometry = new THREE.SphereGeometry(moonData.radius, 12, 12);
            const moonMaterial = new THREE.MeshStandardMaterial({ color: moonData.color, metalness: 0.3, roughness: 0.8 });
            const moon = new THREE.Mesh(moonGeometry, moonMaterial);
            moon.userData = moonData;
            moon.userData.key = `${planetKey}_moon_${moonIndex}`;
            moon.userData.type = 'Moon';

            const moonGroup = new THREE.Group();
            moonGroup.add(moon);
            moon.position.x = moonData.distance;
            planet.add(moonGroup);

            celestialBodies[planetKey].moons.push({ moon: moon, group: moonGroup, angle: Math.random() * Math.PI * 2, data: moonData });
        }

        // ==================== Solar System Functions ====================
        function animateSolarSystem() {
            animationId = requestAnimationFrame(animateSolarSystem);
            solarControls.update();

            // Rotate and orbit planets
            Object.keys(celestialBodies).forEach(key => {
                if (key !== 'sun') {
                    const body = celestialBodies[key];
                    body.angle += celestialData[key].orbitSpeed * 0.001 * orbitSpeed;
                    body.group.rotation.y = body.angle;
                    body.planet.rotation.y += celestialData[key].rotationSpeed * orbitSpeed;
                    body.moons.forEach(moonObj => {
                        moonObj.angle += moonObj.data.orbitSpeed * 0.01 * orbitSpeed;
                        moonObj.group.rotation.y = moonObj.angle;
                    });
                } else {
                    celestialBodies.sun.rotation.y += 0.001 * orbitSpeed;
                }
            });

            solarRenderer.render(solarScene, solarCamera);
        }

        function setupSolarSystemUI() {
            // Planet buttons
            const planetButtons = document.getElementById('planetButtonsMobile');
            Object.keys(celestialData).forEach(key => {
                const button = document.createElement('button');
                button.className = 'planet-btn-mobile';
                button.textContent = celestialData[key].name;
                button.onclick = () => focusOnPlanet(key);
                planetButtons.appendChild(button);
            });

            // Speed control
            document.getElementById('speedControlMobile').addEventListener('input', (e) => {
                orbitSpeed = parseFloat(e.target.value);
                document.getElementById('speedValueMobile').textContent = orbitSpeed.toFixed(1) + 'x';
            });

            // Other controls
            document.getElementById('controlToggle').addEventListener('click', () => {
                document.getElementById('bottomControlBar').classList.toggle('hidden');
            });

            document.getElementById('resetCameraMobile').addEventListener('click', () => {
                solarCamera.position.set(0, 80, 150);
                solarControls.target.set(0, 0, 0);
                showToast('Camera reset');
            });

            document.getElementById('toggleAudioMobile').addEventListener('click', toggleAudio);
            document.getElementById('toggleChatMobile').addEventListener('click', () => {
                document.getElementById('infoPanelMobile').classList.remove('active');
                document.getElementById('chatInterfaceMobile').classList.toggle('active');
                document.getElementById('toggleChatMobile').classList.toggle('active');
            });

            document.getElementById('toggleInfoMobile').addEventListener('click', () => {
                document.getElementById('chatInterfaceMobile').classList.remove('active');
                document.getElementById('infoPanelMobile').classList.toggle('active');
                document.getElementById('toggleInfoMobile').classList.toggle('active');
            });

            document.getElementById('closeInfoMobile').addEventListener('click', () => {
                document.getElementById('infoPanelMobile').classList.remove('active');
                document.getElementById('toggleInfoMobile').classList.remove('active');
            });

            document.getElementById('closeChatMobile').addEventListener('click', () => {
                document.getElementById('chatInterfaceMobile').classList.remove('active');
                document.getElementById('toggleChatMobile').classList.remove('active');
            });

            document.getElementById('sendMessageMobile').addEventListener('click', sendChatMessage);
            document.getElementById('chatInputMobile').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    sendChatMessage();
                }
            });

            // Touch interaction
            solarRenderer.domElement.addEventListener('touchend', onTouchEnd);
        }

        function focusOnPlanet(key) {
            if (key === 'sun') {
                solarCamera.position.set(0, 40, 80);
                solarControls.target.set(0, 0, 0);
                showInfoPanel(celestialData.sun);
            } else {
                const body = celestialBodies[key];
                const planet = body.planet;
                const worldPos = new THREE.Vector3();
                planet.getWorldPosition(worldPos);
                const distance = celestialData[key].radius * 5;
                solarCamera.position.set(worldPos.x + distance, worldPos.y + distance/2, worldPos.z + distance);
                solarControls.target.copy(worldPos);
                showInfoPanel(celestialData[key]);
            }
            showToast(`Viewing ${celestialData[key].name}`);
        }

        function showInfoPanel(data) {
            const panel = document.getElementById('infoPanelMobile');
            const title = document.getElementById('infoPanelTitleMobile');
            const content = document.getElementById('infoPanelContentMobile');

            title.textContent = data.name;

            let html = `<p>${data.info}</p>`;
            html += '<div class="info-grid-mobile">';
            if (data.type) html += `<div class="info-item-mobile"><span class="info-label-mobile">Type:</span><span class="info-value-mobile">${data.type}</span></div>`;
            if (data.diameter) html += `<div class="info-item-mobile"><span class="info-label-mobile">Diameter:</span><span class="info-value-mobile">${data.diameter}</span></div>`;
            if (data.mass) html += `<div class="info-item-mobile"><span class="info-label-mobile">Mass:</span><span class="info-value-mobile">${data.mass}</span></div>`;
            if (data.dayLength) html += `<div class="info-item-mobile"><span class="info-label-mobile">Day:</span><span class="info-value-mobile">${data.dayLength}</span></div>`;
            if (data.yearLength) html += `<div class="info-item-mobile"><span class="info-label-mobile">Year:</span><span class="info-value-mobile">${data.yearLength}</span></div>`;
            if (data.moons !== undefined) html += `<div class="info-item-mobile"><span class="info-label-mobile">Moons:</span><span class="info-value-mobile">${data.moons}</span></div>`;
            if (data.temperature) html += `<div class="info-item-mobile"><span class="info-label-mobile">Temp:</span><span class="info-value-mobile">${data.temperature}</span></div>`;
            html += '</div>';

            if (data.funFacts) {
                html += '<h4 style="margin-top: 20px; color: var(--accent-glow); font-size: 16px;">Fun Facts:</h4><ul style="margin-left: 20px; margin-top: 10px;">';
                data.funFacts.forEach(fact => {
                    html += `<li style="margin: 8px 0; color: var(--text-secondary); line-height: 1.5;">${fact}</li>`;
                });
                html += '</ul>';
            }

            content.innerHTML = html;
            panel.classList.add('active');
            document.getElementById('toggleInfoMobile').classList.add('active');
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInputMobile');
            const message = input.value.trim();
            if (!message) return;

            addChatMessage(message, 'user');
            input.value = '';

            setTimeout(() => {
                const response = generateChatResponse(message);
                addChatMessage(response, 'assistant');
            }, 500);
        }

        function addChatMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessagesMobile');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-mobile ${sender}`;

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content-mobile';
            contentDiv.innerHTML = text;

            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateChatResponse(message) {
            const lowerMessage = message.toLowerCase();
            for (const key in celestialData) {
                const data = celestialData[key];
                if (lowerMessage.includes(data.name.toLowerCase())) {
                    focusOnPlanet(key);
                    let response = `<strong>${data.name}</strong> ${data.info}<br><br>`;
                    if (data.funFacts && data.funFacts.length > 0) {
                        response += '<strong>Interesting facts:</strong><ul>';
                        data.funFacts.slice(0, 2).forEach(fact => {
                            response += `<li>${fact}</li>`;
                        });
                        response += '</ul>';
                    }
                    return response;
                }
            }

            const responses = [
                'Try asking about specific planets like "Tell me about Mars" or "How hot is Venus?"',
                'Tap on any planet to learn more, or ask questions like "Which planet is biggest?"',
                'I can help with planets and moons! Try "How many moons does Jupiter have?"'
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function onTouchEnd(event) {
            if (event.touches.length === 0 && event.changedTouches.length > 0) {
                const touch = event.changedTouches[0];
                mouse.x = (touch.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(touch.clientY / window.innerHeight) * 2 + 1;

                raycaster.setFromCamera(mouse, solarCamera);

                const allObjects = [];
                Object.keys(celestialBodies).forEach(key => {
                    if (key === 'sun') {
                        allObjects.push(celestialBodies[key]);
                    } else {
                        allObjects.push(celestialBodies[key].planet);
                        celestialBodies[key].moons.forEach(moonObj => {
                            allObjects.push(moonObj.moon);
                        });
                    }
                });

                const intersects = raycaster.intersectObjects(allObjects);
                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    showInfoPanel(object.userData);
                }
            }
        }

        function toggleAudio() {
            // Audio implementation would go here
            showToast('Audio feature coming soon!');
        }

        function showToast(message) {
            const toast = document.getElementById('toastMobile');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ==================== Event Listeners ====================

        // Window resize
        window.addEventListener('resize', () => {
            if (timelineCamera && timelineRenderer) {
                timelineCamera.aspect = window.innerWidth / window.innerHeight;
                timelineCamera.updateProjectionMatrix();
                timelineRenderer.setSize(window.innerWidth, window.innerHeight);
            }
            if (solarCamera && solarRenderer) {
                solarCamera.aspect = window.innerWidth / window.innerHeight;
                solarCamera.updateProjectionMatrix();
                solarRenderer.setSize(window.innerWidth, window.innerHeight);
            }
        });

        // Prevent default touch behaviors
        document.addEventListener('touchmove', function(e) {
            if (e.target.tagName !== 'INPUT') {
                e.preventDefault();
            }
        }, { passive: false });

        // ==================== Initialization ====================
        // Initialize immediately like the original file
        let currentTime = 0;
        let isPlaying = false;
        let labelsVisible = true;
        let orbitSpeed = 1;
        let audioContext, isAudioPlaying = false;
        let raycaster, mouse, touchStart;

        // Initialize timeline immediately
        initSolarSystem();
        animateSolarSystem();

        // Handle DOM ready events
        window.addEventListener('DOMContentLoaded', () => {
            // Hide loading screen
            setTimeout(() => {
                document.getElementById('loading-screen').classList.add('hidden');
            }, 2000);
        });
    </script>
</body>
</html>
